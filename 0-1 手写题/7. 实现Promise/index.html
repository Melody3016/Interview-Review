<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <!-- <script src="./js/MyPromise.js"></script> -->
    <script src="../../1-4 promise/promise2.js"></script>
  </head>
  <body>
    <!-- <script>
    const p1 = new Promise((resolve, reject) => {
      resolve(1)
      // resolve(123)
      // reject(1)
    })
    // console.log(p1);
    const res1 = p1.then(res => {
      console.log(res);
    })
    console.log(res1);
    const p2 = new MyPromise((resolve, reject) => {
      resolve(1)
      // resolve(123)
      // reject(1)
    })
    // console.log(p2);
    const res2 = p2.then(res => {
      console.log(res);
    })
    console.log(res2);
  </script> -->
    <!-- <script>
      // then链式调用
      /* new Promise((resolve, reject) => {
        resolve(1);
      })
        .then(value => {
          console.log(value);
          return 2;
        })
        .then(value => {
          console.log(value);
          return new Promise((resolve, reject) => {
            resolve(3);
          });
        })
        .then(value => {
          console.log(value);
        })
        .then(value => {
          console.log(value);
          throw 4;
        })
        .then(
          value => {
            console.log(value);
          },
          reason => {
            console.log(reason);
          }
        ); */
      new MyPromise((resolve, reject) => {
        setTimeout(() => {
          resolve(1);
        }, 0)
      })
        .then(value => {
          console.log(value);
          return 2;
        })
        .then(value => {
          console.log(value);
          return new MyPromise((resolve, reject) => {
            resolve(3);
          });
        })
        .then(value => {
          console.log(value);
        })
        .then(value => {
          console.log(value);
          throw 4;
        })
        .catch(reason => {
          console.log(reason);
        })
    </script> -->

    <!-- <script>
      // 错误传透
      /* new Promise((resolve, reject) => {
        resolve(1);
      })
        .then(value => {
          console.log(value);
          return 2;
        })
        .then(value => {
          console.log(value);
          return new Promise((resolve, reject) => {
            reject(3);
          });
        })
        .then(value => {
          console.log(value);
        })
        .then(value => {
          console.log(value);
        })
        .then(value => {
          console.log(value);
        })
        .catch(reason => {
          console.log(reason);
        }); */
      new MyPromise((resolve, reject) => {
        resolve(1);
      })
        .then(value => {
          console.log(value);
          return 2;
        })
        .then(value => {
          console.log(value);
          return new MyPromise((resolve, reject) => {
            reject(3);
          });
        })
        .then(value => {
          console.log(value);
        })
        .then(value => {
          console.log(value);
        })
        .then(value => {
          console.log(value);
        })
        .catch(reason => {
          console.log(reason);
        });
    </script> -->

    <!-- <script>
      // then为值传递
      new Promise((resolve, reject) => {
        resolve(1);
      })
        .then([() => 2])
        .then(value => {
          console.log(value);
        });
      new MyPromise((resolve, reject) => {
        resolve(1);
      })
        .then(1323)
        .then(value => {
          console.log(value);
        });
    </script> -->

    <script>
      // 同一Promise实例多次调用then方法，按照顺序调用
      /* const p1 = new Promise((resolve, reject) => {
        // resolve(1)
        setTimeout(() => {
          reject(1)
        }, 0)
      })
      p1.then(value => {
        console.log('then1', value);
      })
      p1.then(value => {
        console.log('then2', value);
      })
      p1.catch(reason => {
        console.log('catch1', reason);
      })
      p1.catch(reason => {
        console.log('catch2', reason);
      }) */
      /* const p2 = new MyPromise((resolve, reject) => {
        setTimeout(() => {
          // resolve(p1);
          reject(1)
        }, 0);
      });
      p2.then(value => {
        console.log('then1', value);
      });
      p2.then(value => {
        console.log('then2', value);
      });
      p2.catch(reason => {
        console.log('catch1', reason);
      })
      p2.catch(reason => {
        console.log('catch2', reason);
      })
      console.log(p2); */
    </script>

    <!-- <script>
      // 未被处理的错误状态提示
      const p1 = new Promise((resolve, reject) => {
        reject(1)
      })
      console.log(p1);
      const p2 = new MyPromise((resolve, reject) => {
        reject(2)
      })
      console.log(p2);
    </script> -->

    <!-- <script>
      // resolve, reject参数为thenable
      const p1 = new Promise((resolve, reject) => {
        resolve(1);
      });
      const p2 = new Promise((resolve, reject) => {
        reject(2);
      });
      new Promise((resolve, reject) => {
        resolve(p2);
      })
        .then(value => {
          console.log('value', value);
        })
        .catch(reason => {
          console.log('reason', reason);
        });
      //
      new MyPromise((resolve, reject) => {
        resolve(p2);
      })
        .then(value => {
          console.log('value', value);
        })
        .catch(reason => {
          console.log('reason', reason);
        });
    </script> -->

    <script>
      // resolve自身
      /* let r
      const p1 = new Promise((resolve, reject) => {
        r = resolve
      }).then(value => {
        console.log(value);
      })
      r(p1)
      console.log(p1); */
      let r2
      const p2 = new MyPromise((resolve, reject) => {
        r2 = resolve
      }).then(value => {
        console.log(value);
      })
      r2(p2)
      console.log(p2);

    </script>
  </body>
</html>
